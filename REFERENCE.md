# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`clamav`](#clamav): Installs the command line ClamAV anti-virus scanner.
* [`clamav::set_schedule`](#clamavset_schedule): Allows you to set a schedule for ClamAV to run a check on your system via cron

## Classes

### <a name="clamav"></a> `clamav`

If you wish to schedule a virus scan, you will need to create a cron job that
is appropriate, or drop a script into the cron.* directory that is
appropriate.

#### Parameters

The following parameters are available in the `clamav` class:

* [`enable`](#enable)
* [`manage_group_and_user`](#manage_group_and_user)
* [`clamav_user`](#clamav_user)
* [`clamav_group`](#clamav_group)
* [`package_name`](#package_name)
* [`enable_freshclam`](#enable_freshclam)
* [`enable_data_rsync`](#enable_data_rsync)
* [`schedule_scan`](#schedule_scan)
* [`rsync_source`](#rsync_source)
* [`rsync_server`](#rsync_server)
* [`rsync_timeout`](#rsync_timeout)
* [`package_ensure`](#package_ensure)

##### <a name="enable"></a>`enable`

Data type: `Boolean`

Disables/Enables clamav

* Toggles freshclam/clamscan cronjobs, selbooleans, rsync, and package
  installation.

Default value: ``true``

##### <a name="manage_group_and_user"></a>`manage_group_and_user`

Data type: `Boolean`

Optionally manage the clamav user and group.

Default value: ``true``

##### <a name="clamav_user"></a>`clamav_user`

Data type: `String`

The clamav user.

Default value: `'clam'`

##### <a name="clamav_group"></a>`clamav_group`

Data type: `String`

The clamav group.

Default value: `'clam'`

##### <a name="package_name"></a>`package_name`

Data type: `String`

The name of clamav rpm package.

Default value: `'clamav'`

##### <a name="enable_freshclam"></a>`enable_freshclam`

Data type: `Boolean`

If true, will enable the freshclam cron job.

Default value: ``false``

##### <a name="enable_data_rsync"></a>`enable_data_rsync`

Data type: `Boolean`

If true, will use the SIMP rsync subsystem to pull down clamav DAT files.

* NOTE: `$enable_freshclam` takes precedence

Default value: ``false``

##### <a name="schedule_scan"></a>`schedule_scan`

Data type: `Boolean`

If true, will enable the scheduled system scan.

* The default targets are *extremely* conservative so you will probably
  want to adjust this.

Default value: ``true``

##### <a name="rsync_source"></a>`rsync_source`

Data type: `String`

The rsync server source path for the clamav definitions.

* Setting this parameter to an empty String will disable the clamav rsync.

Default value: `"clamav_${::environment}/"`

##### <a name="rsync_server"></a>`rsync_server`

Data type: `Simplib::Host`

The hostname or IP of the rsync server providing clamav definitions.

Default value: `simplib::lookup('simp_options::rsync::server', { 'default_value' => '127.0.0.1' })`

##### <a name="rsync_timeout"></a>`rsync_timeout`

Data type: `Integer`

The amount of time, in seconds, to wait for rsync to respond.

Default value: `simplib::lookup('simp_options::rsync::timeout', { 'default_value' => 2 })`

##### <a name="package_ensure"></a>`package_ensure`

Data type: `String[1]`

The value used for package ensure attribute.

Default value: `simplib::lookup('simp_options::package_ensure', { 'default_value' => 'installed' })`

### <a name="clamavset_schedule"></a>`clamav::set_schedule`

* All 'yes/no' variables have been translated to 'true/false' for consistency.

* Defaults to weekly.

* **See also**
  * clamscan(1)
    * for any undefined variables.

#### Parameters

The following parameters are available in the `clamav::set_schedule` class:

* [`enable`](#enable)
* [`minute`](#minute)
* [`hour`](#hour)
* [`monthday`](#monthday)
* [`month`](#month)
* [`weekday`](#weekday)
* [`nice_level`](#nice_level)
* [`scan_targets`](#scan_targets)
* [`official_db_only`](#official_db_only)
* [`logfile`](#logfile)
* [`recursive`](#recursive)
* [`cross_fs`](#cross_fs)
* [`summary`](#summary)
* [`infected_only`](#infected_only)
* [`bytecode`](#bytecode)
* [`bytecode_unsigned`](#bytecode_unsigned)
* [`bytecode_timeout`](#bytecode_timeout)
* [`detect_pua`](#detect_pua)
* [`exclude_pua`](#exclude_pua)
* [`include_pua`](#include_pua)
* [`max_files`](#max_files)
* [`max_filesize`](#max_filesize)
* [`max_scansize`](#max_scansize)
* [`max_recursion`](#max_recursion)
* [`max_dir_recursion`](#max_dir_recursion)
* [`logrotate`](#logrotate)

##### <a name="enable"></a>`enable`

Data type: `Boolean`

Enables/Disables the clamscan cronjob.  Defaults to true.

Default value: `simplib::lookup('clamav::enable', { 'default_value' => true})`

##### <a name="minute"></a>`minute`

Data type: `Simplib::Cron::Minute`



Default value: `'32'`

##### <a name="hour"></a>`hour`

Data type: `Simplib::Cron::Hour`



Default value: `'5'`

##### <a name="monthday"></a>`monthday`

Data type: `Simplib::Cron::MonthDay`



Default value: `'*'`

##### <a name="month"></a>`month`

Data type: `Simplib::Cron::Month`



Default value: `'*'`

##### <a name="weekday"></a>`weekday`

Data type: `Simplib::Cron::Weekday`



Default value: `'0'`

##### <a name="nice_level"></a>`nice_level`

Data type: `Integer`

The system 'nice' level at which to run the virus scan.

Default value: `19`

##### <a name="scan_targets"></a>`scan_targets`

Data type: `Array[Stdlib::Absolutepath]`

An array of directories upon which to perform this scan.

Default value: `['/tmp','/var/tmp','/dev/shm']`

##### <a name="official_db_only"></a>`official_db_only`

Data type: `Boolean`



Default value: ``true``

##### <a name="logfile"></a>`logfile`

Data type: `Stdlib::Absolutepath`



Default value: `'/var/log/clamscan.log'`

##### <a name="recursive"></a>`recursive`

Data type: `Boolean`



Default value: ``true``

##### <a name="cross_fs"></a>`cross_fs`

Data type: `Boolean`



Default value: ``true``

##### <a name="summary"></a>`summary`

Data type: `Boolean`



Default value: ``false``

##### <a name="infected_only"></a>`infected_only`

Data type: `Boolean`



Default value: ``true``

##### <a name="bytecode"></a>`bytecode`

Data type: `Boolean`



Default value: ``true``

##### <a name="bytecode_unsigned"></a>`bytecode_unsigned`

Data type: `Boolean`



Default value: ``false``

##### <a name="bytecode_timeout"></a>`bytecode_timeout`

Data type: `Integer`



Default value: `60000`

##### <a name="detect_pua"></a>`detect_pua`

Data type: `Boolean`



Default value: ``false``

##### <a name="exclude_pua"></a>`exclude_pua`

Data type: `Array[String]`



Default value: `[]`

##### <a name="include_pua"></a>`include_pua`

Data type: `Array[String]`



Default value: `[]`

##### <a name="max_files"></a>`max_files`

Data type: `Integer`



Default value: `10000`

##### <a name="max_filesize"></a>`max_filesize`

Data type: `Integer`

The maximum archive size to scan, in megabytes.

Default value: `25`

##### <a name="max_scansize"></a>`max_scansize`

Data type: `Integer`

The maximum scanned file size to scan, in megabytes.

Default value: `100`

##### <a name="max_recursion"></a>`max_recursion`

Data type: `Integer`



Default value: `16`

##### <a name="max_dir_recursion"></a>`max_dir_recursion`

Data type: `Integer`



Default value: `15`

##### <a name="logrotate"></a>`logrotate`

Data type: `Boolean`

Enable the use of the SIMP logrotate capabilities.

Default value: `simplib::lookup('simp_options::logrotate', { 'default_value' => false })`

